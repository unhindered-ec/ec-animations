# Evolutionary Computation Animations with Manim

This uses [the Manim library](https://docs.manim.community/en/stable/index.html)
to generate a set of animations illustrating a variety of concepts in evolutionary
computation.

---

## How to generate decent animated GIFs

@JustusFluegel suggested the following to use `ffmpeg` to convert the `.mp4` that `manim` generates into
an animated GIF:

```text
ffmpeg -i TwoPointCrossoverScene.mp4 -vf "fps=15,scale=1080:-1:flags=lanczos,split[s0][s1];[s0]palettegen[p];[s1][p]paletteuse" -loop 0 output.gif
```

The meaning of the various flags:

- `-i` specifies the input file
- `-vf` applies the following set of filters to the video stream:
  - `fps=15` sets the frame rate to 15 frames/second
  - `scale=1080:-1:flags=lanczos` sets several things:
    - the width is set to `1080`
    - the height is set to `-1`, which just says to maintain the initial aspect ratio
    - `flags=lanczos` means it should use sinc-sinc interpolation for the scaling
  - `split[s0][s1];[s0]palettegen[p];[s1][p]paletteuse` is the processing pipeline
    - `split[s0][s1]` splits the video stream into 2 parts, s1 and s0
    - `[s0]palettegen[p]` generates a color palette `p` from the stream `s0`
    - `[s1][p]paletteuse` down samples the video from stream `s1` to use the palette from `p`
- `-loop 0` says to loop forever. `-1` would say to not loop at all. `n` (for n>0) would loop `n` times.

This gave us a reasonable quality animated GIF that was quite small (274KB) compared to the much larger
animated GIFs generated by `manim` (e.g., 3.7MB for 1080p with an fps of 15).

## A better option: AVIF

@JustusFluegel suggested trying the AVIF format, which is more recent, provides very high compression, and supports animation.
[It is also supported by the latest version of major browsers since 2024.](https://caniuse.com/avif)

The following `ffmpeg` command converts our `.mp4` into an `.avif` with a bitrate of 15K, 15 frames per second, scaling to 1080p.

```text
ffmpeg -i TwoPointCrossoverScene.mp4 -b 15K -vf "fps=15" TwoPointCrossover_15pfs.avif
```

We found that not scaling, i.e., leaving it at 2160 instead of 1080, but leaving in the change to 15 FPS, yields
a quite nice output that is still highly scalable but with a file size that is not a lot bigger than using 1080p
(21K vs. 16K, so around 25% larger).

Generating AVIF files is much slower than generating animated GIFs, but if you keep the framerate down (like 15 FPS)
it's not too terrible.

## Two-point crossover

An animation illustrating two-point crossover. The animated AVIF was generated as described above.

![Animation illustrating two-point crossover](animations/TwoPointCrossover.avif)

## N-point crossover

An animation illustrating the more general N-point crossover (with $N=4$ in this example):

![Animation illustrating N-point crossover](animations/NPointCrossover_15pfs.avif)

## Uniform crossover

An animation illustrating uniform crossover, where each gene is selected at random from
one of the two parents.

![Animation illustrating uniform crossover](animations/UniformCrossover_15pfs.avif)
